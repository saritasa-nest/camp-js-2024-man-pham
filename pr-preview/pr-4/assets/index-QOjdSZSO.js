var p=Object.defineProperty;var y=(s,t,e)=>t in s?p(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var n=(s,t,e)=>y(s,typeof t!="symbol"?t+"":t,e);import"./modulepreload-polyfill-B5Qt9EMX.js";class c{constructor(){n(this,"subscribers",[])}subscribe(t){this.getSubscriberIndex(t)===-1&&this.subscribers.push(t)}unsubscribe(t){const e=this.getSubscriberIndex(t);e!==-1&&this.subscribers.splice(e,1)}notify(t){this.subscribers.forEach(e=>e.update(t))}getSubscriberIndex(t){return this.subscribers.findIndex(e=>e===t)}}class a{constructor(){n(this,"diceResults",[]);n(this,"result",new c)}get totalScore(){return this.diceResults.reduce((t,e)=>t+e,0)}updateDicesList(t){this.diceResults.push(t.diceResult)}}class b extends a{update(t){this.updateDicesList(t);const e={dicesOrder:this.diceResults,totalScore:this.totalScore};this.result.notify(e)}}const E=6,i=class i extends c{constructor(e){super();n(this,"sidesCount");this.sidesCount=e}static getInstance(){return i.instance==null&&(i.instance=new i(E)),i.instance}roll(){const e=Math.floor(Math.random()*this.sidesCount)+1;this.notify(e)}};n(i,"instance");let l=i;function m(s){return(s==null?void 0:s.tagName.toLowerCase())==="button"}function f(s){return(s==null?void 0:s.nodeType)===Node.ELEMENT_NODE}class o{constructor(t){n(this,"containerElement",null);this.containerElement=document.getElementById(t)}createElement(t){const e=document.createElement("div");return e.innerHTML=t.trim(),f(e.firstChild)?e.firstChild:null}}class u extends o{constructor(e){super(e);n(this,"resultElement",null);n(this,"totalScoreElement",null);this.containerElement=this.createResultDisplayerElement(e);const r=document.getElementById("wrapper");this.containerElement&&(r==null||r.appendChild(this.containerElement)),this.resultElement=document.getElementById(`${e}-dice-results`),this.totalScoreElement=document.getElementById(`${e}-score`)}createResultDisplayerElement(e){return this.createElement(`<article id="${e}" class="displayer">
				<div>
                	<h2 class="displayer__heading">${e}
						<span id="${e}-score"></span>
					</h2>
				</div>
				<div id="${e}-dice-results" class="displayer__dice-results"></div>
            </article>`)}renderNewResult(e){this.resultElement&&(this.resultElement.innerText=`${e.dicesOrder.join(", ")}`),this.totalScoreElement&&(this.totalScoreElement.innerText=` - ${e.totalScore}`)}update(e){this.renderNewResult(e)}}class I extends o{update(t){var e;if(t){(e=this.containerElement)==null||e.classList.add("displayer_win");const r=document.getElementById("button-roll");m(r)&&(r.disabled=!0,r.innerText="We have a winner ðŸ¥³")}}}const g=21;class x extends a{constructor(e){super();n(this,"winStatus",new c);this.playerIndex=e}update(e){if(e.playerIndex===this.playerIndex){this.updateDicesList(e);const r={dicesOrder:this.diceResults,totalScore:this.totalScore};this.result.notify(r)}this.totalScore>=g&&this.winStatus.notify(!0)}}class S extends c{constructor(e){super();n(this,"currentPlayerIndex",0);this.playerCount=e}moveToNextPlayer(){this.currentPlayerIndex=(this.currentPlayerIndex+1)%this.playerCount}update(e){const r={playerIndex:this.currentPlayerIndex,diceResult:e};this.notify(r),this.moveToNextPlayer()}playTurn(){l.getInstance().roll()}}class w{constructor(){n(this,"playerCount",2);n(this,"diceGenerator",l.getInstance());n(this,"turnGenerator",new S(this.playerCount));const t=new b,e=new u("debugger");t.result.subscribe(e),this.turnGenerator.subscribe(t),this.registerPlayers(),this.diceGenerator.subscribe(this.turnGenerator)}registerPlayers(){Array(this.playerCount).fill(null).map((t,e)=>{const r=new x(e),d=new u(`player${e+1}`),h=new I(`player${e+1}`);r.result.subscribe(d),r.winStatus.subscribe(h),this.turnGenerator.subscribe(r)})}playTurn(){this.turnGenerator.playTurn()}}const T=new w;window.onload=function(){const s=document.getElementById("button-roll");s&&(s.onclick=function(){T.playTurn()})};
